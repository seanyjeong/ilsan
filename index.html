<!DOCTYPE html>
<html>
<head>
  <title>Data Display</title>
  <script>
    let data = [];
    let currentIndex = 0;

    function fetchData() {
      const script = document.createElement('script');
      script.src = 'https://script.google.com/macros/s/AKfycbywls4FX00gnksgdSrqJsWhQSaGox8Eq3HGmdi4nOHfAr4Y4XuKx0UbnjdMGBMNBl_P/exec?callback=updateData';
      document.body.appendChild(script);
    }

    function updateData(fetchedData) {
      data = fetchedData;
      currentIndex = 0;
      displayData();
    }

    function displayData() {
      const output = document.getElementById('output');
      output.innerHTML = '';
      if (data.length > 0) {
        const currentData = data[currentIndex];
        currentData.forEach(function(row) {
          const div = document.createElement('div');
          div.textContent = row.join(', ');
          output.appendChild(div);
        });
        currentIndex = (currentIndex + 1) % data.length;
      }
    }

    window.onload = function() {
      fetchData();
      setInterval(fetchData, 60000);
      setInterval(displayData, 5000);
    };
  </script>
</head>
<body>
  <h1>Data Display</h1>
  <div id="output"></div>
</body>
</html>
